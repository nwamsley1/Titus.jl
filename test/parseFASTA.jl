test = "AAAKNNNKNNN"

@test Set(digest(test, min_length = 1)) == Set(["AAAK","NNNK","NNN","AAAKNNNK","NNNKNNN"])
@test Set(digest(test, min_length =4)) == Set(["AAAK","NNNK","AAAKNNNK","NNNKNNN"])
@test Set(digest(test, min_length = 5)) == Set(["AAAKNNNK","NNNKNNN"])

mouse_protein = "MPLSLFRRVLLAVLLLVIIWTLFGPSGLGEELLSLSLASLLPAPASPGPPLALPRLLISNSHACGGSGPPPFLLILVCTAPEHLNQRNAIRASWGAIREARGFRVQTLFLLGKPRRQQLADLSSESAAHRDILQASFQDSYRNLTLKTLSGLNWVNKYCPMARYILKTDDDVYVNVPELVSELIQRGGPSEQWQKGKEAQEETTAIHEEHRGQAVPLLYLGRVHWRVRPTRTPESRHHVSEELWPENWGPFPPYASGTGYVLSISAVQLILKVASRAPPLPLEDVFVGVSARRGGLAPTHCVKLAGATHYPLDRCCYGKFLLTSHKVDPWQMQEAWKLVSGMNGERTAPFCSWLQGFLGTLRCRFIAWFSS"
#Used `cleaver` bioconductor package in R to get an answer https://bioconductor.org/packages/3.18/bioc/html/cleaver.html
long_seq = ["LLISNSHACGGSGPPPFLLILVCTAPEHLNQR", "VQTLFLLGKPR", "QQLADLSSESAAHR", "DILQASFQDSYR", "TLSGLNWVNK", "TDDDVYVNVPELVSELIQR", "GGPSEQWQK", "EAQEETTAIHEEHR", "GQAVPLLYLGR", "HHVSEELWPENWGPFPPYASGTGYVLSISAVQLILK", "APPLPLEDVFVGVSAR", "GGLAPTHCVK", "LAGATHYPLDR", "VDPWQMQEAWK", "LVSGMNGER", "TAPFCSWLQGFLGTLR", "MPLSLFRR", "LLISNSHACGGSGPPPFLLILVCTAPEHLNQRNAIR", "NAIRASWGAIR", "ASWGAIREAR", "GFRVQTLFLLGKPR", "VQTLFLLGKPRR", "RQQLADLSSESAAHR", "QQLADLSSESAAHRDILQASFQDSYR", "DILQASFQDSYRNLTLK", "NLTLKTLSGLNWVNK", "TLSGLNWVNKYCPMAR", "YCPMARYILK", "YILKTDDDVYVNVPELVSELIQR", "TDDDVYVNVPELVSELIQRGGPSEQWQK", "GGPSEQWQKGK", "GKEAQEETTAIHEEHR", "EAQEETTAIHEEHRGQAVPLLYLGR", "GQAVPLLYLGRVHWR", "VHWRVRPTR", "VRPTRTPESR", "HHVSEELWPENWGPFPPYASGTGYVLSISAVQLILKVASR", "VASRAPPLPLEDVFVGVSAR", "APPLPLEDVFVGVSARR", "RGGLAPTHCVK", "GGLAPTHCVKLAGATHYPLDR", "LAGATHYPLDRCCYGK", "CCYGKFLLTSHK", "FLLTSHKVDPWQMQEAWK", "VDPWQMQEAWKLVSGMNGER", "LVSGMNGERTAPFCSWLQGFLGTLR", "TAPFCSWLQGFLGTLRCR", "CRFIAWFSS"]

@test Set(digest(mouse_protein, missed_cleavages = 1)) == Set(long_seq)

long_seq_10missed = ["LLISNSHACGGSGPPPFLLILVCTAPEHLNQR", "VQTLFLLGKPR", "QQLADLSSESAAHR", "DILQASFQDSYR", "TLSGLNWVNK", "TDDDVYVNVPELVSELIQR", "GGPSEQWQK", "EAQEETTAIHEEHR", "GQAVPLLYLGR", "HHVSEELWPENWGPFPPYASGTGYVLSISAVQLILK", "APPLPLEDVFVGVSAR", "GGLAPTHCVK", "LAGATHYPLDR", "VDPWQMQEAWK", "LVSGMNGER", "TAPFCSWLQGFLGTLR", "MPLSLFRR", "LLISNSHACGGSGPPPFLLILVCTAPEHLNQRNAIR", "NAIRASWGAIR", "ASWGAIREAR", "GFRVQTLFLLGKPR", "VQTLFLLGKPRR", "RQQLADLSSESAAHR", "QQLADLSSESAAHRDILQASFQDSYR", "DILQASFQDSYRNLTLK", "NLTLKTLSGLNWVNK", "TLSGLNWVNKYCPMAR", "YCPMARYILK", "YILKTDDDVYVNVPELVSELIQR", "TDDDVYVNVPELVSELIQRGGPSEQWQK", "GGPSEQWQKGK", "GKEAQEETTAIHEEHR", "EAQEETTAIHEEHRGQAVPLLYLGR", "GQAVPLLYLGRVHWR", "VHWRVRPTR", "VRPTRTPESR", "HHVSEELWPENWGPFPPYASGTGYVLSISAVQLILKVASR", "VASRAPPLPLEDVFVGVSAR", "APPLPLEDVFVGVSARR", "RGGLAPTHCVK", "GGLAPTHCVKLAGATHYPLDR", "LAGATHYPLDRCCYGK", "CCYGKFLLTSHK", "FLLTSHKVDPWQMQEAWK", "VDPWQMQEAWKLVSGMNGER", "LVSGMNGERTAPFCSWLQGFLGTLR", "TAPFCSWLQGFLGTLRCR", "CRFIAWFSS", "NAIRASWGAIREAR", "ASWGAIREARGFR", "EARGFRVQTLFLLGKPR", "GFRVQTLFLLGKPRR", "VQTLFLLGKPRRQQLADLSSESAAHR", "RQQLADLSSESAAHRDILQASFQDSYR", "QQLADLSSESAAHRDILQASFQDSYRNLTLK", "DILQASFQDSYRNLTLKTLSGLNWVNK", "NLTLKTLSGLNWVNKYCPMAR", "TLSGLNWVNKYCPMARYILK", "YCPMARYILKTDDDVYVNVPELVSELIQR", "YILKTDDDVYVNVPELVSELIQRGGPSEQWQK", "TDDDVYVNVPELVSELIQRGGPSEQWQKGK", "GGPSEQWQKGKEAQEETTAIHEEHR", "GKEAQEETTAIHEEHRGQAVPLLYLGR", "EAQEETTAIHEEHRGQAVPLLYLGRVHWR", "GQAVPLLYLGRVHWRVRPTR", "VHWRVRPTRTPESR", "VASRAPPLPLEDVFVGVSARR", "APPLPLEDVFVGVSARRGGLAPTHCVK", "RGGLAPTHCVKLAGATHYPLDR", "GGLAPTHCVKLAGATHYPLDRCCYGK", "LAGATHYPLDRCCYGKFLLTSHK", "CCYGKFLLTSHKVDPWQMQEAWK", "FLLTSHKVDPWQMQEAWKLVSGMNGER", "VDPWQMQEAWKLVSGMNGERTAPFCSWLQGFLGTLR", "LVSGMNGERTAPFCSWLQGFLGTLRCR", "TAPFCSWLQGFLGTLRCRFIAWFSS", "NAIRASWGAIREARGFR", "ASWGAIREARGFRVQTLFLLGKPR", "EARGFRVQTLFLLGKPRR", "GFRVQTLFLLGKPRRQQLADLSSESAAHR", "VQTLFLLGKPRRQQLADLSSESAAHRDILQASFQDSYR", "RQQLADLSSESAAHRDILQASFQDSYRNLTLK", "DILQASFQDSYRNLTLKTLSGLNWVNKYCPMAR", "NLTLKTLSGLNWVNKYCPMARYILK", "TLSGLNWVNKYCPMARYILKTDDDVYVNVPELVSELIQR", "YCPMARYILKTDDDVYVNVPELVSELIQRGGPSEQWQK", "YILKTDDDVYVNVPELVSELIQRGGPSEQWQKGK", "GGPSEQWQKGKEAQEETTAIHEEHRGQAVPLLYLGR", "GKEAQEETTAIHEEHRGQAVPLLYLGRVHWR", "EAQEETTAIHEEHRGQAVPLLYLGRVHWRVRPTR", "GQAVPLLYLGRVHWRVRPTRTPESR", "VASRAPPLPLEDVFVGVSARRGGLAPTHCVK", "APPLPLEDVFVGVSARRGGLAPTHCVKLAGATHYPLDR", "RGGLAPTHCVKLAGATHYPLDRCCYGK", "GGLAPTHCVKLAGATHYPLDRCCYGKFLLTSHK", "LAGATHYPLDRCCYGKFLLTSHKVDPWQMQEAWK", "CCYGKFLLTSHKVDPWQMQEAWKLVSGMNGER", "VDPWQMQEAWKLVSGMNGERTAPFCSWLQGFLGTLRCR", "LVSGMNGERTAPFCSWLQGFLGTLRCRFIAWFSS", "NAIRASWGAIREARGFRVQTLFLLGKPR", "ASWGAIREARGFRVQTLFLLGKPRR", "EARGFRVQTLFLLGKPRRQQLADLSSESAAHR", "DILQASFQDSYRNLTLKTLSGLNWVNKYCPMARYILK", "YCPMARYILKTDDDVYVNVPELVSELIQRGGPSEQWQKGK", "GGPSEQWQKGKEAQEETTAIHEEHRGQAVPLLYLGRVHWR", "GKEAQEETTAIHEEHRGQAVPLLYLGRVHWRVRPTR", "EAQEETTAIHEEHRGQAVPLLYLGRVHWRVRPTRTPESR", "RGGLAPTHCVKLAGATHYPLDRCCYGKFLLTSHK", "NAIRASWGAIREARGFRVQTLFLLGKPRR", "ASWGAIREARGFRVQTLFLLGKPRRQQLADLSSESAAHR"]

@test Set(digest(mouse_protein, missed_cleavages = 1)) == Set(long_seq)